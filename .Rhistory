geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.1))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.15))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.18))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.2))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.23))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.25))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.3))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.4))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.5))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8))
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8), size = 12)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8), size = 8)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8), size = 6)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8), size = 5)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.85, vjust = -0.8), size = 6)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -0.8), size = 6)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -1), size = 6)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -1), size = 5.5)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -1), size = 5.4)
pie_chart
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -1), size = 5.3)
pie_chart
mlb_info
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = TRUE)
#install.packages("bookdown")
library(bookdown)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(data.table)
library(tidyverse)
library(tidymodels)
library(xgboost)
library(doParallel)
library(vip)
library(caret)
library(Boruta)
library(randomForest)
library(kableExtra)
library(leaflet)
library(maps)
library(mapdata)
library(mapproj)
library(reshape2)
#Load in datasets
draft_info <- fread('Data/clean_draft.csv')
draft_info <-
draft_info %>%
mutate(mlb_years = ifelse(mlb_played_first == 0 & mlb_played_last == 0, 0,
(mlb_played_last - mlb_played_first) + 1 ) )
## below _df objects contain data ONLY from players with at least 1 game in the
## MLB
bat_draft_df <- fread('Data/bat_subset.csv')
pitch_draft_df <- fread('Data/pitch_subset.csv')
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = TRUE)
#install.packages("bookdown")
library(bookdown)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(corrplot)
library(data.table)
library(tidyverse)
library(tidymodels)
library(xgboost)
library(doParallel)
library(vip)
library(caret)
library(Boruta)
library(randomForest)
library(kableExtra)
library(leaflet)
library(maps)
library(mapdata)
library(mapproj)
library(reshape2)
#Load in datasets
draft_info <- fread('Data/clean_draft.csv')
draft_info <-
draft_info %>%
mutate(mlb_years = ifelse(mlb_played_first == 0 & mlb_played_last == 0, 0,
(mlb_played_last - mlb_played_first) + 1 ) )
## below _df objects contain data ONLY from players with at least 1 game in the
## MLB
bat_draft_df <- fread('Data/bat_subset.csv')
pitch_draft_df <- fread('Data/pitch_subset.csv')
# Create a dataframe with state naming data
state_data <- data.frame(names = state.name, abbreviation = tolower(state.abb))
draft_info <-
draft_info %>%
left_join(state_data, by = c("home_state" = "abbreviation")) %>%
select(-home_state) %>%
rename(home_state = names) %>%
drop_na(home_state)
# Subset the data to only players drafted in the first 10 rounds
first_10 <-
draft_info %>%
filter(as.integer(pick_round) %in% c(1:10)) %>%
drop_na(high_school) %>%
group_by(pick_round, high_school) %>%
summarise(num_players = n()) %>%
arrange(desc(num_players)) %>%
ungroup() %>%
mutate(pick_round = factor(pick_round, levels = c(1:10)),
high_school = as.factor(ifelse(high_school == "Yes", "High School",
"College")))
hs_by_round_plot <-
ggplot(first_10, aes(x = pick_round, y = num_players, fill = high_school)) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Total Players", x = "Draft Round",
title = "Number of Draftees by Pick and Round",
fill = "High School Player") +
theme_minimal()
hs_by_round_plot
#Created a new variable for each dataset that gives the number of years it took for a player
#to play their first MLB game
bat_draft_df$DifferenceYearsDraftFGPlayed <- bat_draft_df$mlb_played_first - bat_draft_df$year
pitch_draft_df$DifferenceYearsDraftFGPlayed <- pitch_draft_df$mlb_played_first - pitch_draft_df$year
plot1 <- ggplot(bat_draft_df, aes(x = DifferenceYearsDraftFGPlayed)) +
geom_histogram(binwidth = 0.5, fill = "skyblue", color = "black", alpha = 0.8) +
labs(title = "Years for a Batting Draftee to Play Their First MLB Game",
x = "# of Years", y = "Frequency") +
theme_minimal()
plot2 <- ggplot(pitch_draft_df, aes(x = DifferenceYearsDraftFGPlayed)) +
geom_histogram(binwidth = 0.5, fill = "orange", color = "black", alpha = 0.8) +
labs(title = "Years for a Pitching Draftee to Play Their First MLB Game",
x = "# of Years", y = "Frequency") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
plot1 <- ggplot(bat_draft_df, aes(x = person_weight, y=person_height)) +
geom_point(fill="skyblue", shape=21, size=2, alpha = 0.8) +
geom_hline(yintercept = mean(bat_draft_df$person_height,na.rm=T),
color = "red", linetype = "dashed", alpha = 0.8) +
geom_vline(xintercept = mean(bat_draft_df$person_weight,na.rm=T),
color = "blue", linetype = "dashed", alpha = 0.8) +
geom_text(aes(x = mean(bat_draft_df$person_weight,na.rm=T) + 1,
y = mean(bat_draft_df$person_height,na.rm=T),
label = paste("Mean Weight")),
color = "blue", hjust = 0, vjust = -15, alpha = 0.8) +
geom_text(aes(x = mean(bat_draft_df$person_weight,na.rm=T),
y = mean(bat_draft_df$person_height,na.rm=T) - 1,
label = paste("Mean Height")),
color = "red", hjust = -3, vjust = 0, alpha = 0.8) +
geom_smooth(method = "lm", se = FALSE, color = "black", alpha = 0.8) +
labs(title = "Weight vs. Height (Batters)",
x = "Draftee Weight", y = "Draftee Height") +
theme_minimal()
plot2 <- ggplot(pitch_draft_df, aes(x = person_weight, y=person_height)) +
geom_point(fill="orange", shape=21, size=2, alpha = 0.8) +
geom_hline(yintercept = mean(pitch_draft_df$person_height,na.rm=T),
color = "red", linetype = "dashed", alpha = 0.8) +
geom_vline(xintercept = mean(pitch_draft_df$person_weight,na.rm=T),
color = "blue", linetype = "dashed", alpha = 0.8) +
geom_text(aes(x = mean(pitch_draft_df$person_weight,na.rm=T) + 1,
y = mean(pitch_draft_df$person_height,na.rm=T),
label = paste("Mean Weight")),
color = "blue", hjust = 0, vjust = -16, alpha = 0.8) +
geom_text(aes(x = mean(pitch_draft_df$person_weight,na.rm=T),
y = mean(pitch_draft_df$person_height,na.rm=T) - 1,
label = paste("Mean Height")),
color = "red", hjust = -2.8, vjust = 0, alpha = 0.8) +
geom_smooth(method = "lm", se = FALSE, color = "black", alpha = 0.8) +
labs(title = "Weight vs. Height (Pitchers)",
x = "Draftee Weight", y = "Draftee Height") +
theme_minimal()
grid.arrange(plot1, plot2, nrow = 1)
par(mfrow=c(1,2))
# %>% full_join(pitch_draft_df)
bat_draft_df1 <- bat_draft_df %>%
mutate(pick_round=as.numeric(pick_round)) %>%
drop_na()
correlation_matrix <- cor(bat_draft_df1[, c(4,5,7,9,10)])
corrplot(correlation_matrix, method = "color")
title("Correlation Plot (Batting)",line = 3,adj=0)
#title(sub = "Plot 5: Correlation Plot of Batters", line=4.5)
pitch_draft_df1 <- pitch_draft_df %>%
mutate(pick_round=as.numeric(pick_round)) %>%
drop_na()
correlation_matrix <- cor(pitch_draft_df1[, c(4,5,7,9,10)])
corrplot(correlation_matrix, method = "color")
title("Correlation Plot (Pitching)",line = 3,adj=0)
#title(sub = "Plot 6: Correlation Plot of Pitchers", line=4.5)
# Create a frequency of the states of drafted draft_info
state_freq <- table(draft_info$home_state)
# Convert the table to a datafram
state_freq_df <-
data.frame(region = tolower(names(state_freq)), # convert states to lowercase
frequency = as.numeric(state_freq)) %>% # draft_info from each state
arrange(desc(frequency)) %>% # arrange in descending order of draft_info drafted
filter(!(region %in% c("hawaii", "alaska"))) # View only contiguous U.S.
# Mapping data for the United States map
states <- map_data("state")
# Create a dataframe with the coordinates, and the frequencies in each state
map.df <-
merge(states, state_freq_df, by="region", all.x=T) %>%
rename(longitude = long, latitude = lat) %>%
select(-subregion) %>%
filter(region %in% state_freq_df$region)
map.df <- map.df[order(map.df$order),] # make sure the dataframe is ordered
# Create a heat map of the draft_info drafted by home_state
home_heat_map <-
ggplot(map.df, aes(x = longitude, y = latitude, group = group)) +
geom_polygon(aes(fill=frequency)) +
geom_path() +
scale_fill_gradient(low = "white", high = "darkred",
name = "Players Drafted") +
labs(title = "Heat Map of Drafted Players") +
theme(plot.title = element_text(hjust = 0.5))
home_heat_map
players <- bind_rows(bat_draft_df, pitch_draft_df) %>%
arrange(desc(fWAR)) %>%
distinct(person_id, .keep_all = T)
players$time_played <- (players$mlb_played_last - players$mlb_played_first) + 1
ggplot(players, aes(x = time_played, y=fWAR)) +
geom_point(fill="white", shape=21, size=2, alpha = 0.8) +
geom_hline(yintercept = mean(players$fWAR,na.rm=T),
color = "red", linetype = "dashed", alpha = 0.8) +
geom_vline(xintercept = mean(players$time_played,na.rm=T),
color = "blue", linetype = "dashed", alpha = 0.8) +
geom_text(aes(x = mean(players$time_played,na.rm=T)+0.5,
y = mean(players$fWAR,na.rm=T)+40,
label = paste("Mean Time")),
color = "blue", hjust = 0, vjust = -10, alpha = 0.8) +
geom_text(aes(x = mean(players$time_played,na.rm=T)+8,
y = mean(players$fWAR,na.rm=T)+5,
label = paste("Mean WAR")),
color = "red", hjust = -4, vjust = 0, alpha = 0.8) +
labs(title = "Total Time in MLB vs. WAR",
x = "Total Time Played in MLB", y = "Wins Above Replacement") +
theme_minimal()
# load in full batters draft data
bat_draft <-
fread('Data/batters/batters_full_draft.csv') %>%
select(fg_playerID, person_id, person_full_name, fWAR, pick_round,
pick_number, year, person_birth_state_province,
person_height, person_weight, home_state,
person_primary_position_abbreviation,
person_bat_side_code, person_pitch_hand_code,
mlb_played_first, mlb_played_last, high_school,
birth_year)
# load in full pitchers draft data
pitch_draft <-
fread('Data/pitchers/pitchers_full_draft.csv') %>%
select(fg_playerID, person_id, person_full_name, fWAR, pick_round,
pick_number, year, person_birth_state_province,
person_height, person_weight, home_state,
person_primary_position_abbreviation,
person_bat_side_code, person_pitch_hand_code,
mlb_played_first, mlb_played_last, high_school, birth_year
)
# bind them into players data
players <-
bind_rows(pitch_draft, bat_draft) %>%
mutate(pick_round = as.numeric(pick_round)) %>%
filter(pick_round %in% c(1:100)) %>%
group_by(person_id) %>%
# Choose the player's most recent draft year (if drafted more than once)
dplyr::slice(which.max(year)) %>%
ungroup() %>%
# Add these classifier variables for data table presentation
mutate(less_five_war = ifelse(fWAR < 5, 1, 0),
five_to_10 = ifelse(fWAR >= 5 & fWAR < 10, 1, 0),
ten_to_15 = ifelse(fWAR >= 10 & fWAR < 15, 1, 0),
fifteen_to_20 = ifelse(fWAR >= 15 & fWAR < 20, 1, 0),
twenty_to_25 = ifelse(fWAR >= 20 & fWAR <= 25, 1, 0),
more_than_25 = ifelse(fWAR > 25, 1, 0),
yrs_before_debut = mlb_played_first - year,
time_played = (mlb_played_last - mlb_played_first) + 1,
debut_age = mlb_played_first - birth_year,
draft_age = debut_age - yrs_before_debut) %>%
arrange(desc(fWAR))
# fWAR info by draft year
fwar_info_by_year <-
players %>%
group_by(year) %>%
summarise(`Less than 5 fWAR` = round(sum(less_five_war) / n() * 100, 2),
`5-10 fWAR` = round(sum(five_to_10) / n() * 100, 2),
`10-15 fWAR` = round(sum(ten_to_15) / n() * 100, 2),
`15-20 fWAR` = round(sum(fifteen_to_20) / n() * 100, 2),
`20-25 fWAR` = round(sum(twenty_to_25) / n() * 100, 2),
`Greater than 25 fWAR` = round(sum(more_than_25) / n() * 100, 2)) %>%
mutate(`Less than 5 fWAR` = paste(`Less than 5 fWAR`, "%", sep = " "),
`5-10 fWAR` = paste(`5-10 fWAR`, "%", sep = " "),
`10-15 fWAR` = paste(`10-15 fWAR`, "%", sep = " "),
`15-20 fWAR` = paste(`15-20 fWAR`, "%", sep = " "),
`20-25 fWAR` = paste(`20-25 fWAR`, "%", sep = " "),
`Greater than 25 fWAR` = paste(`Greater than 25 fWAR`, "%", sep = " "))
# round_numbers <-
#   as.numeric(unique(players$pick_round[which(as.numeric(players$pick_round) %in% c(1:100))])) %>%
#   sort()
# # fWAR info summarised by draft round
# fwar_info_by_round <-
#   players %>%
#   mutate(pick_round = factor(pick_round, levels = round_numbers)) %>%
#   group_by(pick_round) %>%
#   summarise(`Less than 5 fWAR` = round(sum(less_five_war) / n() * 100, 2),
#             `5-10 fWAR` = round(sum(five_to_10) / n() * 100, 2),
#             `10-15 fWAR` = round(sum(ten_to_15) / n() * 100, 2),
#             `15-20 fWAR` = round(sum(fifteen_to_20) / n() * 100, 2),
#             `20-25 fWAR` = round(sum(twenty_to_25) / n() * 100, 2),
#             `Greater than 25 fWAR` = round(sum(more_than_25) / n() * 100, 2)) %>%
#   mutate(`Less than 5 fWAR` = paste(`Less than 5 fWAR`, "%", sep = " "),
#          `5-10 fWAR` = paste(`5-10 fWAR`, "%", sep = " "),
#          `10-15 fWAR` = paste(`10-15 fWAR`, "%", sep = " "),
#          `15-20 fWAR` = paste(`15-20 fWAR`, "%", sep = " "),
#          `20-25 fWAR` = paste(`20-25 fWAR`, "%", sep = " "),
#          `Greater than 25 fWAR` = paste(`Greater than 25 fWAR`, "%", sep = " "))
# Reload in the untouched draft_info
draft_info <- fread('Data/draft_data.csv') %>%
mutate(mlb_played_first = year(person_mlb_debut_date),
high_school = ifelse(str_detect(school_name, "\\sHS") == TRUE, "Yes",
"No"),
person_height = str_replace_all(person_height, "\"$", "")) %>%
replace_na(list(home_state = "None", mlb_played_first = 0)) %>%
mutate(mlb_played_last = ifelse(mlb_played_first == 0, 0,
year(person_last_played_date)),
made_mlb = ifelse(mlb_played_first == 0, 0, 1)) %>%
replace_na(list(mlb_played_last = 2023)) %>%
# Remove variables of no interest
select(-person_link, -c(person_use_name:person_gender),
-c(person_name_slug:person_init_last_name),
-c(person_name_matrilineal:home_city), -c(home_country, school_state),
-c(person_xref_ids:person_death_country), -person_name_title, -team_id,
-person_name_suffix, -c(team_link:team_spring_league_abbreviation),
-headshot_link, home_state)
# Full Draft information breakdown by draft year
mlb_info <-
draft_info %>%
# mutate to a factor for sorting purposes
mutate(pick_round = as.numeric(draft_info$pick_round))  %>%
filter(pick_round %in% c(1:100)) %>%
group_by(person_id) %>%
dplyr::slice(which.max(year)) %>%
ungroup() %>%
summarise(`Drafted` = n(), # total number of draftees
`Made MLB` = sum(made_mlb), # number of draftees to make MLB
# percent of players to make the MLB
`% Made MLB` = round( (`Made MLB` / `Drafted`) * 100, 2),
# percent of players to NOT make the MLB
`% Missed MLB` = round((100 - `% Made MLB`), 2))
mlb_info_long <-
mlb_info %>%
pivot_longer(cols = c( `Made MLB`,  `Drafted`), names_to = "Category",
values_to = "Total Players")
pie_chart <-
ggplot(data = mlb_info_long, aes(x = "", y = `Total Players`, fill = Category)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Pie Chart of MLB Status") +
geom_text(aes(label = c(paste(mlb_info$`% Made MLB`, "%", sep = ""), paste(mlb_info$`% Missed MLB`, "%", sep = "")), hjust = 0.75, vjust = -1), size = 5.3)
pie_chart
# Total fWAR by draft class (year)
total_fwar_by_year <-
players %>%
group_by(year) %>%
summarise(total_fWAR = sum(fWAR)) %>%
arrange(desc(total_fWAR)) %>%
mutate(rank = c(1:59) )
fwar_levels <-
total_fwar_by_year %>%
slice_head(n = 10) %>%
select(year) %>%
unlist() %>%
as.character()
colnames(draft_info)
unique(c(colnames(draft_info), colnames(players)))
